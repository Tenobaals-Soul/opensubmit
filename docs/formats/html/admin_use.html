<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Admin manual &#8212; OpenSubmit  documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Developer manual" href="developer_use.html" />
    <link rel="prev" title="Teacher manual" href="backend_use.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          OpenSubmit</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="about.html">About</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Manuals <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="frontend_use.html">Student manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend_use.html">Teacher manual</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Admin manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_use.html">Developer manual</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Jump to... <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Admin manual</a><ul>
<li><a class="reference internal" href="#web-application">Web application</a><ul>
<li><a class="reference internal" href="#updating-your-installation">Updating your installation</a></li>
<li><a class="reference internal" href="#authentication-methods">Authentication methods</a><ul>
<li><a class="reference internal" href="#login-with-openid">Login with OpenID</a></li>
<li><a class="reference internal" href="#login-with-shibboleth">Login with Shibboleth</a></li>
<li><a class="reference internal" href="#login-with-google-account">Login with Google account</a></li>
<li><a class="reference internal" href="#login-with-twitter-account">Login with Twitter account</a></li>
<li><a class="reference internal" href="#login-with-github-account">Login with GitHub account</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-management">User management</a><ul>
<li><a class="reference internal" href="#user-permissions">User permissions</a></li>
<li><a class="reference internal" href="#merging-accounts">Merging accounts</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#test-machines">Test machines</a><ul>
<li><a class="reference internal" href="#id1">Updating your installation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="admin-manual">
<h1>Admin manual<a class="headerlink" href="#admin-manual" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This manual is work in progress and therefore incomplete. Feel free to help us with a <a class="reference external" href="https://github.com/troeger/opensubmit">pull request on GitHub</a>.</p>
</div>
<div class="section" id="web-application">
<h2>Web application<a class="headerlink" href="#web-application" title="Permalink to this headline">¶</a></h2>
<p>OpenSubmit runs with Python 3.4 or newer versions. For an installation, you need to follow these steps:</p>
<ul class="simple">
<li>Prepare a Python 3 web hosting environment.<ul>
<li>Debian / Ubuntu: <code class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">libapache2-mod-wsgi-py3</span> <span class="pre">apache2</span> <span class="pre">sqlite</span> <span class="pre">python3</span></code>.</li>
</ul>
</li>
<li>Run <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">opensubmit-web</span></code> as root or in a virtualenv environment. If you get error messages about unresolved dependencies, try running <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-U</span> <span class="pre">opensubmit-web</span></code>. PIP should come as part of your Python installation.</li>
<li>Run <code class="docutils literal"><span class="pre">opensubmit-web</span> <span class="pre">configure</span></code> to create an OpenSubmit configuration file template. Edit the generated file (<code class="docutils literal"><span class="pre">/etc/opensubmit/settings.ini</span></code>):<ul>
<li>The default database is SQLite. You can use an empty MySQL, PostgreSQL or Oracle database instead.</li>
<li>OpenSubmit does not support password-based logins. You need to choose one of the supported <a class="reference internal" href="#auth"><span class="std std-ref">authentication methods</span></a>.</li>
<li>Configure a MEDIA_ROOT folder that stores all the student uploads.</li>
</ul>
</li>
<li>Re-run <code class="docutils literal"><span class="pre">opensubmit-web</span> <span class="pre">configure</span></code> to check your configuration. If everything looks good, then a default Apache 2.4 configuration for mod_wsgi is generated in <code class="docutils literal"><span class="pre">/etc/opensubmit/apache24.config</span></code>.  You can <a class="reference external" href="http://httpd.apache.org/docs/2.4/en/mod/core.html#include">include</a> this file in some <a class="reference external" href="http://httpd.apache.org/docs/2.4/vhosts/examples.html">virtual host configuration</a>.</li>
<li>Restart your web server.</li>
<li>Got to the OpenSubmit start page and use your configured authentication method.</li>
<li>Run <code class="docutils literal"><span class="pre">opensubmit-web</span> <span class="pre">makeadmin</span> <span class="pre">&lt;email&gt;</span></code> to make the created user an administrator in the system.</li>
</ul>
<div class="section" id="updating-your-installation">
<h3>Updating your installation<a class="headerlink" href="#updating-your-installation" title="Permalink to this headline">¶</a></h3>
<p>Updating an existing OpenSubmit web installation consists of the following steps:</p>
<ul class="simple">
<li>Run <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">opensubmit-web</span></code> as root or in a virtualenv environment.</li>
<li>Run <code class="docutils literal"><span class="pre">opensubmit-web</span> <span class="pre">configure</span></code> to perform neccessary database updates.</li>
<li>Restart your web server.</li>
</ul>
</div>
<div class="section" id="authentication-methods">
<h3>Authentication methods<a class="headerlink" href="#authentication-methods" title="Permalink to this headline">¶</a></h3>
<p id="auth">OpenSubmit supports different authentication methods, as described in the following sections. There is <strong>no password login</strong> support in OpenSubmit - authentication is always supposed to be handled by some third-party service.</p>
<p>If you need another authentication method for your institution, please <a class="reference external" href="https://github.com/troeger/opensubmit/issues/new">open an according issue</a>.</p>
<div class="section" id="login-with-openid">
<h4>Login with OpenID<a class="headerlink" href="#login-with-openid" title="Permalink to this headline">¶</a></h4>
<p>If you want to allow users to login with OpenID, you need to configure the following settings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">LOGIN_OPENID:</span> <span class="pre">True</span></code></li>
<li><code class="docutils literal"><span class="pre">LOGIN_DESCRIPTION:</span> <span class="pre">&lt;visible</span> <span class="pre">button</span> <span class="pre">title&gt;</span></code></li>
<li><code class="docutils literal"><span class="pre">OPENID_PROVIDER:</span> <span class="pre">&lt;provider</span> <span class="pre">URL&gt;</span></code></li>
</ul>
<p>The standard OpenSubmit installation already contains an example setting for using StackExchange as OpenID provider.</p>
</div>
<div class="section" id="login-with-shibboleth">
<h4>Login with Shibboleth<a class="headerlink" href="#login-with-shibboleth" title="Permalink to this headline">¶</a></h4>
<p>If you want to allow users to login with Shibboleth, you need to configure the following settings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">LOGIN_SHIB:</span> <span class="pre">True</span></code></li>
<li><code class="docutils literal"><span class="pre">LOGIN_SHIB_DESCRIPTION:</span> <span class="pre">&lt;visible</span> <span class="pre">button</span> <span class="pre">title&gt;</span></code></li>
</ul>
<p>You also need a fully working installation of the <a class="reference external" href="https://wiki.shibboleth.net/confluence/display/SHIB2/NativeSPApacheConfig">Apache 2.4 mod_shib</a> module. The authentication module of OpenSubmit assumes that, as result of the work of <em>mod_shib</em>, the following environment variables are given:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">REMOTE_USER</span></code>: The user name of the authenticated user.</li>
<li><code class="docutils literal"><span class="pre">HTTP_SHIB_ORGPERSON_EMAILADDRESS</span></code>: The email address of the authenticated user.</li>
<li><code class="docutils literal"><span class="pre">HTTP_SHIB_INETORGPERSON_GIVENNAME</span></code>: The first name of the authenticated user.</li>
<li><code class="docutils literal"><span class="pre">HTTP_SHIB_PERSON_SURNAME</span></code>: The last name of the authenticated user.</li>
</ul>
<p>Note: If you are using Apache 2.4 with <em>mod_wsgi</em>, make sure to set <code class="docutils literal"><span class="pre">WSGIPassAuthorization</span> <span class="pre">On</span></code>. Otherwise, these environment variables may not pass through.</p>
</div>
<div class="section" id="login-with-google-account">
<h4>Login with Google account<a class="headerlink" href="#login-with-google-account" title="Permalink to this headline">¶</a></h4>
<p>If you want to allow users to login with an Google account, you need to configure the following settings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">LOGIN_GOOGLE:</span> <span class="pre">True</span></code></li>
<li><code class="docutils literal"><span class="pre">LOGIN_GOOGLE_OAUTH_KEY:</span> <span class="pre">&lt;OAuth</span> <span class="pre">key&gt;</span></code></li>
<li><code class="docutils literal"><span class="pre">LOGIN_GOOGLE_OAUTH_SECRET:</span> <span class="pre">&lt;OAuth</span> <span class="pre">secret&gt;</span></code></li>
</ul>
<p>The standard OpenSubmit installation already contains a key/secret pair for development purposes. It only works for OpenSubmit installations operating on <em>http://localhost:8000</em>, so in a production environment, you need a new pair of OAuth key/secret for your server.</p>
<p>A new pair can be created in the <a class="reference external" href="https://console.developers.google.com/apis/credentials">Google API Console</a>. The authorized forwarding URL should be <code class="docutils literal"><span class="pre">&lt;base</span> <span class="pre">url</span> <span class="pre">of</span> <span class="pre">your</span> <span class="pre">installation&gt;/complete/google-oauth2/</span></code>.</p>
<p>You also need to <a class="reference external" href="https://console.developers.google.com/apis/api/plus.googleapis.com/overview">activate the Google+ API</a>, so that OpenSubmit is able to fetch basic user information from Google.</p>
</div>
<div class="section" id="login-with-twitter-account">
<h4>Login with Twitter account<a class="headerlink" href="#login-with-twitter-account" title="Permalink to this headline">¶</a></h4>
<p>If you want to allow users to login with an Twitter account, you need to configure the following settings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">LOGIN_TWITTER:</span> <span class="pre">True</span></code></li>
<li><code class="docutils literal"><span class="pre">LOGIN_TWITTER_OAUTH_KEY:</span> <span class="pre">&lt;OAuth</span> <span class="pre">key&gt;</span></code></li>
<li><code class="docutils literal"><span class="pre">LOGIN_TWITTER_OAUTH_SECRET:</span> <span class="pre">&lt;OAuth</span> <span class="pre">secret&gt;</span></code></li>
</ul>
<p>The standard OpenSubmit installation already contains a key/secret pair for development purposes. It only works for OpenSubmit installations operating on <em>http://localhost:8000</em>, so in a production environment, you need a new pair of OAuth key/secret for your server.</p>
<p>A new key / secret pair can be created in the <a class="reference external" href="https://apps.twitter.com/">Twitter Application Management</a>.  The authorized forwarding URL should be <code class="docutils literal"><span class="pre">&lt;base</span> <span class="pre">url</span> <span class="pre">of</span> <span class="pre">your</span> <span class="pre">installation&gt;/complete/twitter/</span></code>. We recommend to modify the application access to <em>Read only</em>, and to allow access to the email addresses.</p>
</div>
<div class="section" id="login-with-github-account">
<h4>Login with GitHub account<a class="headerlink" href="#login-with-github-account" title="Permalink to this headline">¶</a></h4>
<p>If you want to allow users to login with an GitHub account, you need to configure the following settings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">LOGIN_GITHUB:</span> <span class="pre">True</span></code></li>
<li><code class="docutils literal"><span class="pre">LOGIN_GITHUB_OAUTH_KEY:</span> <span class="pre">&lt;OAuth</span> <span class="pre">key&gt;</span></code></li>
<li><code class="docutils literal"><span class="pre">LOGIN_GITHUB_OAUTH_SECRET:</span> <span class="pre">&lt;OAuth</span> <span class="pre">secret&gt;</span></code></li>
</ul>
<p>The standard OpenSubmit installation already contains a key/secret pair for development purposes. It only works for OpenSubmit installations operating on <em>http://localhost:8000</em>, so in a production environment, you need a new pair of OAuth key/secret for your server.</p>
<p>A new key / secret pair can be created in the <a class="reference external" href="https://github.com/settings/applications/new">OAuth application registration</a>.  The authorized forwarding URL should be <code class="docutils literal"><span class="pre">&lt;base</span> <span class="pre">url</span> <span class="pre">of</span> <span class="pre">your</span> <span class="pre">installation&gt;/complete/github/</span></code>.</p>
</div>
</div>
<div class="section" id="user-management">
<h3>User management<a class="headerlink" href="#user-management" title="Permalink to this headline">¶</a></h3>
<div class="section" id="user-permissions">
<h4>User permissions<a class="headerlink" href="#user-permissions" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="merging-accounts">
<span id="permissions"></span><h4>Merging accounts<a class="headerlink" href="#merging-accounts" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
<div class="section" id="test-machines">
<span id="merge-users"></span><h2>Test machines<a class="headerlink" href="#test-machines" title="Permalink to this headline">¶</a></h2>
<ul class="simple" id="executors">
<li>Choose a dedicated machine beside the web server. This will compile (and run) the student submissions.</li>
<li>Think again. IT WILL RUN THE STUDENT SUBMISSIONS. Perform all neccessary security precautions, such as network isolation and limited local rights.</li>
<li>Run <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">opensubmit-exec</span></code> as root or in a virtualenv environment. If you get error messages about unresolved dependencies, try running <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-U</span> <span class="pre">opensubmit-exec</span></code>.</li>
<li>Run <code class="docutils literal"><span class="pre">opensubmit-exec</span> <span class="pre">configure</span></code> and follow the instructions. Make sure that you adjust <code class="docutils literal"><span class="pre">/etc/opensubmit/executor.ini</span></code> accordingly. You can run the script multiple times to check your configuration.</li>
<li>Add a call to <code class="docutils literal"><span class="pre">opensubmit-exec</span> <span class="pre">run</span></code> to cron, so that it regulary asks the web server for fresh work. We have good experiences with a 30s interval. You can also do it manually for testing purposes.</li>
</ul>
<p>Smart students may try to connect to their own machines from their code, mainly to copy tutor validation scripts. An easy prevention mechanism for that is the restriction of your test machine routing to the OpenSubmit web server only.</p>
<div class="section" id="id1">
<h3>Updating your installation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Updating an existing OpenSubmit test machine installation consists of the following steps:</p>
<ul class="simple">
<li>Run <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">opensubmit-exec</span></code> as root or in a virtualenv environment.</li>
<li>Run <code class="docutils literal"><span class="pre">opensubmit-exec</span> <span class="pre">configure</span></code> to check the configuration for compatibility.</li>
</ul>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017, Peter Tröger.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>